{"version":3,"sources":["components/FakeWindow.js","components/Stopwatch.js","CustomAgentUIExample.js","App.js","index.js"],"names":["FakeWindow","props","className","style","children","Stopwatch","this","interval","setInterval","forceUpdate","clearInterval","start","moment","end","Date","now","ms","diff","delta","duration","hours","utc","format","Component","cobrowse","CobrowseAPI","CustomAgentUIExample","useState","session","setSession","tool","setTool","context","setContext","screenInfo","setScreenInfo","iframe","a","attachContext","ctx","window","cobrowse_ctx","on","toJSON","isEnded","destroy","info","pickTool","useEffect","intervalId","time","state","width","updated","getTime","renderTimeoutMessage","ref","title","frameBorder","src","api","demoId","token","activated","onClick","icon","faPen","faMarker","clearAnnotations","faTrash","faHandPointer","setFullDevice","full_device","faDesktop","endSession","faPhone","App","params","cobrowseio_demo_id","license","device_name","height","renderCustomerView","fetchToken","demoid","localStorage","cobrowse_demo_id","fetch","res","json","render","ReactDOM","StrictMode","document","getElementById","Math","random"],"mappings":"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","file":"static/js/main.2bb8bb7f.chunk.js","sourcesContent":["import './FakeWindow.css'\n\nexport default function FakeWindow(props) {\n  return (\n    <div className='FakeWindow' style={props.style}>\n      <div className='window-chrome'>\n        <div className='window-chrome-buttons' />\n        <div className='window-chrome-address' />\n        { props.children }\n      </div>\n    </div>\n  )\n}\n","import React, { Component } from 'react'\nimport moment from 'moment'\n\nexport default class Stopwatch extends Component {\n  componentDidMount () {\n    this.interval = setInterval(() => {\n      this.forceUpdate()\n    }, 1000)\n  }\n\n  componentWillUnmount () {\n    clearInterval(this.interval)\n  }\n\n  render () {\n    const start = moment(this.props.start || 0)\n    const end = moment(this.props.end || Date.now())\n    const ms = moment(end).diff(start)\n    const delta = moment.duration(ms)\n    return (\n      <div style={this.props.style} className='Stopwatch'>\n        {delta.hours() > 0 ? <span>{delta.hours()}<span>:</span></span> : null}\n        <span>{moment.utc(ms).format('mm:ss')}</span>\n      </div>\n    )\n  }\n}\n","import React, { useState, useEffect } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTrash, faPhone, faPen, faMarker, faDesktop, faHandPointer } from '@fortawesome/free-solid-svg-icons'\nimport CobrowseAPI from 'cobrowse-agent-sdk'\nimport Stopwatch from './components/Stopwatch'\nimport './CustomAgentUIExample.css'\n\nconst cobrowse = new CobrowseAPI()\n\nexport default function CustomAgentUIExample(props) {\n  const [ session, setSession ] = useState(null)\n  const [ tool, setTool ] = useState('laser')\n  const [ context, setContext ] = useState()\n  const [ screenInfo, setScreenInfo ] = useState()\n\n  // we show some messages a few seconds after a timestamp, so\n  // so we need for force renders to catch that\n  useEffect(() => {\n    const intervalId = setInterval(() => setScreenInfo({ ...screenInfo, time: Date.now() }), 500)\n    return () => clearInterval(intervalId)\n  }, [screenInfo])\n\n  async function onIframeRef(iframe) {\n    if ((!context) && iframe) {\n      const ctx = await cobrowse.attachContext(iframe)\n      window.cobrowse_ctx = ctx\n      ctx.on('session.updated', session => {\n        // update the component session state\n        setSession(session.toJSON())\n        // when the session ends, trigger some cleanup of the context\n        if (session.isEnded()) {\n          ctx.destroy()\n          setContext(null)\n        }\n      })\n      ctx.on('screen.updated', info => {\n        setScreenInfo(info)\n      })\n      setContext(ctx)\n    }\n  }\n\n  function pickTool(tool) {\n    setTool(tool)\n    context?.setTool(tool)\n  }\n\n  function renderConnectingMessage() {\n    if (!session || session?.state === 'pending') return <div className={'loading'}>Custom connecting to device message...</div>\n    if (session?.state === 'authorizing') return <div className={'loading'}>Custom waiting for user to accept message...</div>\n    if (!(screenInfo?.width)) return <div className={'loading'}>Custom loading loading video stream message...</div>\n    return null\n  }\n\n  function renderTimeoutMessage() {\n    if (session?.state === 'active' && screenInfo?.updated) {\n      const updated = new Date(screenInfo?.updated)\n      const delta = Date.now() - updated.getTime()\n      if (delta > 10 * 1000) return <div className={'disconnected'}>Having trouble reaching the device!</div>\n    }\n    return null\n  }\n\n  function renderControls () {\n    if (session?.state !== 'active') return null\n    return (\n      <div className='agent-controls'>\n        <div className='timer'>\n          <Stopwatch start={session.activated} />\n        </div>\n        <div onClick={() => pickTool('laser')} title={'Laser Pointer'} className={`btn btn-left-most ${tool === 'laser' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faPen} />\n        </div>\n        <div onClick={() => pickTool('drawing')} title={'Draw'} className={`btn ${tool === 'drawing' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faMarker} />\n        </div>\n        <div onClick={() => context.clearAnnotations()} title={'Clear Drawing'} className='btn'>\n          <FontAwesomeIcon icon={faTrash} />\n        </div>\n        <div onClick={() => pickTool('control')} title={'Remote Control'} className={`btn ${tool === 'control' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faHandPointer} />\n        </div>\n        <div onClick={() => context.setFullDevice(!session.full_device)} title={'Full Device Mode'} className={`btn ${session.full_device ? 'full-device-on' : ''}`}>\n          <FontAwesomeIcon icon={faDesktop} />\n        </div>\n        <div onClick={() => context.endSession()} title={'End Screenshare'} className='btn btn-right-most btn-end'>\n          <FontAwesomeIcon icon={faPhone} className='fa-rotate-180' />\n        </div>\n      </div>\n    )\n  }\n\n  if (session?.state === 'ended') return <div>The custom agent UI session has ended!</div>\n\n  return (\n    <div className='CustomAgentUIExample'>\n      <div className='agent-session'>\n        { renderConnectingMessage() }\n        { renderTimeoutMessage() }\n        <iframe\n          ref={onIframeRef}\n          className={'screen'}\n          title='Agent Session'\n          frameBorder={0}\n          src={`${props.api}/connect?filter_cobrowseio_demo_id=${props.demoId}&token=${props.token}&end_action=none&agent_tools=none&device_controls=none&session_details=none&popout=none&messages=none`}\n        />\n        { renderControls() }\n      </div>\n    </div>\n  )\n}\n","import FakeWindow from './components/FakeWindow'\nimport CustomAgentUIExample from './CustomAgentUIExample'\nimport './App.css'\n\nfunction App(props) {\n  function renderCustomerView () {\n    const params = {\n      cobrowseio_demo_id: props.demoId,\n      license: 'trial',\n      api: props.api,\n      device_name: 'Trial Website'\n    }\n    return (\n      <div className='customer-view'>\n        <h2>Your Customer</h2>\n        <FakeWindow>\n          <iframe\n            className='device'\n            title='Device'\n            frameBorder={0}\n            width={'100%'}\n            height={'100%'}\n            src={`${props.api}/todomvc/index.html?cobrowseio_demo_id=${params.cobrowseio_demo_id}&device_name=Web%20Trial%20Device&license=${params.license}&api=${params.api}`}\n          />\n        </FakeWindow>\n      </div>\n    )\n  }\n\n  function renderAgentView () {\n    return (\n      <div className='agent-view'>\n        <h2>Your Support Agent</h2>\n        <FakeWindow>\n            <CustomAgentUIExample {...props} />\n        </FakeWindow>\n      </div>\n    )\n  }\n\n  return (\n    <div className='App'>\n      {renderAgentView()}\n      {renderCustomerView()}\n    </div>\n  )\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nconst api = 'https://cobrowse.io'\n\nasync function fetchToken (demoid) {\n  // !! WARNING READ THIS !!\n  // You should NOT use this endpoint to get your own token. This endpoint is\n  // specific to the cobrowse.io hosted online demo. It will not work with your\n  // account and devices.\n  // You should fetch a token in an authenticated way from your own server for\n  // the user. See our documentation on generating a JWT for cobrowse:\n  // https://docs.cobrowse.io/agent-side-integrations/custom-iframe-integrations/json-web-tokens-jwts\n  if (!demoid) return\n  window.localStorage.cobrowse_demo_id = demoid\n  const res = await fetch(`${api}/api/1/demo/token?cobrowseio_demo_id=${demoid}`)\n  const { token } = await res.json()\n  return token\n}\n\n\nfunction render (token, demoId, api) {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App token={token} demoId={demoId} api={api} />\n    </React.StrictMode>,\n    document.getElementById('root')\n  )\n}\n\n;(async function() {\n  const demoId = Date.now()*Math.random()\n  const token = await fetchToken(demoId)\n  render(token, demoId, api)\n})()\n"],"sourceRoot":""}