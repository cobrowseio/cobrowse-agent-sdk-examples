{"version":3,"sources":["components/FakeWindow.js","components/Stopwatch.js","CustomAgentUIExample.js","App.js","index.js"],"names":["FakeWindow","props","className","style","children","Stopwatch","this","interval","setInterval","forceUpdate","clearInterval","start","moment","end","Date","now","ms","diff","delta","duration","hours","utc","format","Component","cobrowse","CobrowseAPI","CustomAgentUIExample","useState","session","setSession","error","setError","tool","setTool","context","setContext","screenInfo","setScreenInfo","iframe","a","attachContext","ctx","window","cobrowse_ctx","on","toJSON","isEnded","destroy","info","err","pickTool","useEffect","intervalId","time","state","console","log","id","width","updated","getTime","renderTimeoutMessage","ref","title","frameBorder","src","api","demoId","token","activated","onClick","icon","faPen","faMarker","clearAnnotations","faTrash","faHandPointer","setFullDevice","full_device","faDesktop","endSession","faPhone","App","params","cobrowseio_demo_id","license","device_name","height","renderCustomerView","fetchToken","demoid","localStorage","cobrowse_demo_id","fetch","res","json","render","ReactDOM","StrictMode","document","getElementById","Math","random"],"mappings":"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","file":"static/js/main.efb87be3.chunk.js","sourcesContent":["import './FakeWindow.css'\n\nexport default function FakeWindow(props) {\n  return (\n    <div className='FakeWindow' style={props.style}>\n      <div className='window-chrome'>\n        <div className='window-chrome-buttons' />\n        <div className='window-chrome-address' />\n        { props.children }\n      </div>\n    </div>\n  )\n}\n","import React, { Component } from 'react'\nimport moment from 'moment'\n\nexport default class Stopwatch extends Component {\n  componentDidMount () {\n    this.interval = setInterval(() => {\n      this.forceUpdate()\n    }, 1000)\n  }\n\n  componentWillUnmount () {\n    clearInterval(this.interval)\n  }\n\n  render () {\n    const start = moment(this.props.start || 0)\n    const end = moment(this.props.end || Date.now())\n    const ms = moment(end).diff(start)\n    const delta = moment.duration(ms)\n    return (\n      <div style={this.props.style} className='Stopwatch'>\n        {delta.hours() > 0 ? <span>{delta.hours()}<span>:</span></span> : null}\n        <span>{moment.utc(ms).format('mm:ss')}</span>\n      </div>\n    )\n  }\n}\n","import React, { useState, useEffect } from 'react'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faTrash, faPhone, faPen, faMarker, faDesktop, faHandPointer } from '@fortawesome/free-solid-svg-icons'\nimport CobrowseAPI from 'cobrowse-agent-sdk'\nimport Stopwatch from './components/Stopwatch'\nimport './CustomAgentUIExample.css'\n\nconst cobrowse = new CobrowseAPI()\n\nexport default function CustomAgentUIExample(props) {\n  const [ session, setSession ] = useState(null)\n  const [ error, setError ] = useState(null)\n  const [ tool, setTool ] = useState('laser')\n  const [ context, setContext ] = useState()\n  const [ screenInfo, setScreenInfo ] = useState()\n\n  // we show some messages a few seconds after a timestamp, so\n  // so we need for force renders to catch that\n  useEffect(() => {\n    const intervalId = setInterval(() => setScreenInfo({ ...screenInfo, time: Date.now() }), 500)\n    return () => clearInterval(intervalId)\n  }, [screenInfo])\n\n  async function onIframeRef(iframe) {\n    if ((!context) && iframe) {\n      const ctx = await cobrowse.attachContext(iframe)\n      window.cobrowse_ctx = ctx\n      ctx.on('session.updated', session => {\n        // update the component session state\n        setSession(session.toJSON())\n        // when the session ends, trigger some cleanup of the context\n        if (session.isEnded()) {\n          ctx.destroy()\n          setContext(null)\n        }\n      })\n      ctx.on('screen.updated', info => {\n        setScreenInfo(info)\n      })\n      ctx.on('error', err => {\n        setError(err)\n      })\n      setContext(ctx)\n    }\n  }\n\n  function pickTool(tool) {\n    setTool(tool)\n    context?.setTool(tool)\n  }\n\n  function renderError() {\n    console.log(error)\n    if (error) return <div className={'error'}><b>Your custom error screen</b><p>id = {error.id}</p></div>\n    return null\n  }\n\n  function renderConnectingMessage() {\n    if (!session || session?.state === 'pending') return <div className={'loading'}>Custom connecting to device message...</div>\n    if (session?.state === 'authorizing') return <div className={'loading'}>Custom waiting for user to accept message...</div>\n    if (!(screenInfo?.width)) return <div className={'loading'}>Custom loading loading video stream message...</div>\n    return null\n  }\n\n  function renderTimeoutMessage() {\n    if (session?.state === 'active' && screenInfo?.updated) {\n      const updated = new Date(screenInfo?.updated)\n      const delta = Date.now() - updated.getTime()\n      if (delta > 10 * 1000) return <div className={'disconnected'}>Having trouble reaching the device!</div>\n    }\n    return null\n  }\n\n  function renderControls () {\n    if (session?.state !== 'active') return null\n    return (\n      <div className='agent-controls'>\n        <div className='timer'>\n          <Stopwatch start={session.activated} />\n        </div>\n        <div onClick={() => pickTool('laser')} title={'Laser Pointer'} className={`btn btn-left-most ${tool === 'laser' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faPen} />\n        </div>\n        <div onClick={() => pickTool('drawing')} title={'Draw'} className={`btn ${tool === 'drawing' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faMarker} />\n        </div>\n        <div onClick={() => context.clearAnnotations()} title={'Clear Drawing'} className='btn'>\n          <FontAwesomeIcon icon={faTrash} />\n        </div>\n        <div onClick={() => pickTool('control')} title={'Remote Control'} className={`btn ${tool === 'control' ? 'btn-selected' : ''}`}>\n          <FontAwesomeIcon icon={faHandPointer} />\n        </div>\n        <div onClick={() => context.setFullDevice(!session.full_device)} title={'Full Device Mode'} className={`btn ${session.full_device ? 'full-device-on' : ''}`}>\n          <FontAwesomeIcon icon={faDesktop} />\n        </div>\n        <div onClick={() => context.endSession()} title={'End Screenshare'} className='btn btn-right-most btn-end'>\n          <FontAwesomeIcon icon={faPhone} className='fa-rotate-180' />\n        </div>\n      </div>\n    )\n  }\n\n  if (session?.state === 'ended') return <div>The custom agent UI session has ended!</div>\n\n  return (\n    <div className='CustomAgentUIExample'>\n      <div className='agent-session'>\n        { renderError() }\n        { renderConnectingMessage() }\n        { renderTimeoutMessage() }\n        <iframe\n          ref={onIframeRef}\n          className={'screen'}\n          title='Agent Session'\n          frameBorder={0}\n          src={`${props.api}/connect?filter_cobrowseio_demo_id=${props.demoId}&token=${props.token}&end_action=none&agent_tools=none&device_controls=none&session_details=none&popout=none&messages=none`}\n        />\n        { renderControls() }\n      </div>\n    </div>\n  )\n}\n","import FakeWindow from './components/FakeWindow'\nimport CustomAgentUIExample from './CustomAgentUIExample'\nimport './App.css'\n\nfunction App(props) {\n  function renderCustomerView () {\n    const params = {\n      cobrowseio_demo_id: props.demoId,\n      license: 'trial',\n      api: props.api,\n      device_name: 'Trial Website'\n    }\n    return (\n      <div className='customer-view'>\n        <h2>Your Customer</h2>\n        <FakeWindow>\n          <iframe\n            className='device'\n            title='Device'\n            frameBorder={0}\n            width={'100%'}\n            height={'100%'}\n            src={`https://cobrowseio.github.io/todo-mvc-example/index.html?cobrowseio_demo_id=${params.cobrowseio_demo_id}&device_name=Web%20Trial%20Device&license=${params.license}&api=${params.api}`}\n          />\n        </FakeWindow>\n      </div>\n    )\n  }\n\n  function renderAgentView () {\n    return (\n      <div className='agent-view'>\n        <h2>Your Support Agent</h2>\n        <FakeWindow>\n            <CustomAgentUIExample {...props} />\n        </FakeWindow>\n      </div>\n    )\n  }\n\n  return (\n    <div className='App'>\n      {renderAgentView()}\n      {renderCustomerView()}\n    </div>\n  )\n}\n\nexport default App;\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\n\nconst api = 'https://cobrowse.io'\n\nasync function fetchToken (demoid) {\n  // !! WARNING READ THIS !!\n  // You should NOT use this endpoint to get your own token. This endpoint is\n  // specific to the cobrowse.io hosted online demo. It will not work with your\n  // account and devices.\n  // You should fetch a token in an authenticated way from your own server for\n  // the user. See our documentation on generating a JWT for cobrowse:\n  // https://docs.cobrowse.io/agent-side-integrations/custom-iframe-integrations/json-web-tokens-jwts\n  if (!demoid) return\n  window.localStorage.cobrowse_demo_id = demoid\n  const res = await fetch(`${api}/api/1/demo/token?cobrowseio_demo_id=${demoid}`)\n  const { token } = await res.json()\n  return token\n}\n\n\nfunction render (token, demoId, api) {\n  ReactDOM.render(\n    <React.StrictMode>\n      <App token={token} demoId={demoId} api={api} />\n    </React.StrictMode>,\n    document.getElementById('root')\n  )\n}\n\n;(async function() {\n  const demoId = Date.now()*Math.random()\n  const token = await fetchToken(demoId)\n  render(token, demoId, api)\n})()\n"],"sourceRoot":""}